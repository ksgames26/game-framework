'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
exports.update = exports.$ = exports.template = void 0;
const fs_1 = require("fs");
exports.template = `
<ui-prop type="dump" class="content"></ui-prop>
`;
exports.$ = {
    content: '.content',
};
const createSelectorProp = (labelText, selectorClassName, selectorDefaultValue, selectorOptions = [], selectCb = null) => {
    const selectorProp = document.createElement('ui-prop');
    const label = document.createElement('ui-label');
    label.setAttribute('slot', 'label');
    label.innerText = labelText;
    const selector = createSelector(selectorClassName, selectorDefaultValue, selectorOptions, selectCb);
    selectorProp.appendChild(label);
    selectorProp.appendChild(selector);
    return selectorProp;
};
const createSelector = (className, defaultValue, selectorOptions = [], selectCb = null) => {
    const selector = document.createElement('ui-select');
    selector.setAttribute('class', className);
    selector.setAttribute('slot', 'content');
    if (defaultValue) {
        selector.setAttribute('value', defaultValue);
    }
    selectorOptions.forEach((option) => {
        selector.appendChild(createOption(option));
    });
    selector.addEventListener('change', (event) => {
        var _a;
        //@ts-ignore
        selectCb && selectCb((_a = event.target) === null || _a === void 0 ? void 0 : _a.value);
    });
    selector.addEventListener('confirm', (event) => {
        var _a;
        //@ts-ignore
        selectCb && selectCb((_a = event.target) === null || _a === void 0 ? void 0 : _a.value);
    });
    return selector;
};
const createOption = (selectorOption) => {
    const option = document.createElement('option');
    option.setAttribute('value', selectorOption.value);
    option.innerText = selectorOption.text;
    return option;
};
async function update(dump) {
    var _a;
    this.dump = dump;
    const content = this.$.content;
    for (const key in dump.value) {
        const value = dump.value[key];
        let $prop = content.querySelector(`ui-prop[key=${key}]`);
        if ($prop) {
            $prop.hidden = !value.visible;
        }
        if (!value.visible) {
            continue;
        }
        if (!$prop) {
            $prop = document.createElement('ui-prop');
            $prop.setAttribute('key', key);
            $prop.setAttribute('type', 'dump');
            content.appendChild($prop);
        }
        $prop.render(value);
        if (key == "defaultClip") {
            const uuid = (_a = value === null || value === void 0 ? void 0 : value.value) === null || _a === void 0 ? void 0 : _a.uuid;
            if (uuid) {
                const assetInfo = await Editor.Message.request('asset-db', 'query-asset-info', uuid);
                if (assetInfo) {
                    const data = (0, fs_1.readFileSync)(assetInfo.file, 'utf8');
                    try {
                        const json = JSON.parse(data);
                        if (json && Array.isArray(json)) {
                            const clip = json.find(item => item.__type__ == "cc.AnimationClip");
                            if (clip) {
                                const clipEvents = clip._events;
                                if (clipEvents && Array.isArray(clipEvents)) {
                                    const map = new Map();
                                    for (const event of clipEvents) {
                                        const has = map.get(event.frame);
                                        if (has) {
                                            // 有名字的事件会替换掉没有名字的事件
                                            if (!has.func && event.func) {
                                                map.set(event.frame, event);
                                            }
                                        }
                                        else {
                                            map.set(event.frame, event);
                                        }
                                    }
                                    const events = Array.from(map.values());
                                    $prop = content.querySelector(`ui-prop[key=State]`);
                                    if ($prop) {
                                        const existingSelector = $prop.querySelector('ui-select');
                                        if (existingSelector) {
                                            // 记录当前选中的值
                                            const currentValue = existingSelector.getAttribute('value');
                                            // 清空现有options
                                            while (existingSelector.firstChild) {
                                                existingSelector.removeChild(existingSelector.firstChild);
                                            }
                                            // 添加新的options
                                            events.forEach((event, index) => {
                                                const option = createOption({
                                                    value: index.toString(),
                                                    text: event.func || "状态" + (index + 1)
                                                });
                                                existingSelector.appendChild(option);
                                            });
                                            // 恢复之前选中的值
                                            existingSelector.setAttribute('value', currentValue);
                                            await Editor.Message.request('scene', 'execute-component-method', {
                                                uuid: dump.value.uuid.value,
                                                name: 'editorChangeState',
                                                args: currentValue,
                                            });
                                        }
                                        return;
                                    }
                                    $prop = createSelectorProp("State", "event", "0", events.map((event, index) => ({ value: index.toString(), text: event.func || "状态" + (index + 1) })), async (v) => {
                                        await Editor.Message.request('scene', 'execute-component-method', {
                                            uuid: dump.value.uuid.value,
                                            name: 'editorChangeState',
                                            args: v,
                                        });
                                    });
                                    $prop.setAttribute("key", "State");
                                    content.appendChild($prop);
                                    const state = await Editor.Message.request('scene', 'execute-component-method', {
                                        uuid: dump.value.uuid.value,
                                        name: 'editorGetState',
                                    });
                                    const selector = $prop.querySelector('ui-select');
                                    if (selector) {
                                        selector.setAttribute('value', state);
                                        await Editor.Message.request('scene', 'execute-component-method', {
                                            uuid: dump.value.uuid.value,
                                            name: 'editorChangeState',
                                            args: state,
                                        });
                                    }
                                }
                            }
                        }
                    }
                    catch (error) {
                        console.error("Failed to parse view state data:", error);
                    }
                }
            }
        }
    }
}
exports.update = update;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlldy1zdGF0ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NvdXJjZS9pbnNwZWN0b3Ivdmlldy1zdGF0ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxZQUFZLENBQUM7OztBQUdiLDJCQUFrQztBQU1yQixRQUFBLFFBQVEsR0FBRzs7Q0FFdkIsQ0FBQztBQUVXLFFBQUEsQ0FBQyxHQUFHO0lBQ2IsT0FBTyxFQUFFLFVBQVU7Q0FDdEIsQ0FBQztBQUdGLE1BQU0sa0JBQWtCLEdBQUcsQ0FBQyxTQUFpQixFQUFFLGlCQUF5QixFQUFFLG9CQUE2QixFQUFFLGtCQUFvQyxFQUFFLEVBQUUsV0FBb0MsSUFBSyxFQUFlLEVBQUU7SUFDdk0sTUFBTSxZQUFZLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUN2RCxNQUFNLEtBQUssR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQ2pELEtBQUssQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ3BDLEtBQUssQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO0lBQzVCLE1BQU0sUUFBUSxHQUFHLGNBQWMsQ0FBQyxpQkFBaUIsRUFBRSxvQkFBb0IsRUFBRSxlQUFlLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDcEcsWUFBWSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNoQyxZQUFZLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBRW5DLE9BQU8sWUFBWSxDQUFDO0FBQ3hCLENBQUMsQ0FBQztBQUVGLE1BQU0sY0FBYyxHQUFHLENBQUMsU0FBaUIsRUFBRSxZQUFxQixFQUFFLGtCQUFvQyxFQUFFLEVBQUUsV0FBb0MsSUFBSyxFQUFlLEVBQUU7SUFDaEssTUFBTSxRQUFRLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUNyRCxRQUFRLENBQUMsWUFBWSxD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RCxJQUFJLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSzs0Q0FDM0IsSUFBSSxFQUFFLG1CQUFtQjs0Q0FDekIsSUFBSSxFQUFFLEtBQUs7eUNBQ2QsQ0FBQyxDQUFDO3FDQUNOO2lDQUNKOzZCQUNKO3lCQUNKO3FCQUNKO29CQUFDLE9BQU8sS0FBSyxFQUFFO3dCQUNaLE9BQU8sQ0FBQyxLQUFLLENBQUMsa0NBQWtDLEVBQUUsS0FBSyxDQUFDLENBQUM7cUJBQzVEO2lCQUNKO2FBQ0o7U0FDSjtLQUNKO0FBQ0wsQ0FBQztBQXhJRCx3QkF3SUMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmltcG9ydCB7IEFzc2V0SW5mbyB9IGZyb20gXCJAY29jb3MvY3JlYXRvci10eXBlcy9lZGl0b3IvcGFja2FnZXMvYXNzZXQtZGIvQHR5cGVzL3B1YmxpY1wiO1xuaW1wb3J0IHsgcmVhZEZpbGVTeW5jIH0gZnJvbSBcImZzXCI7XG5cbnR5cGUgU2VsZWN0b3I8JD4gPSB7ICQ6IFJlY29yZDxrZXlvZiAkLCBhbnkgfCBudWxsPiB9O1xuXG50eXBlIFBhbmVsVGhpcyA9IFNlbGVjdG9yPHR5cGVvZiAkPiAmIHsgZHVtcDogYW55IH07XG5cbmV4cG9ydCBjb25zdCB0ZW1wbGF0ZSA9IGBcbjx1aS1wcm9wIHR5cGU9XCJkdW1wXCIgY2xhc3M9XCJjb250ZW50XCI+PC91aS1wcm9wPlxuYDtcblxuZXhwb3J0IGNvbnN0ICQgPSB7XG4gICAgY29udGVudDogJy5jb250ZW50Jyxcbn07XG5cblxuY29uc3QgY3JlYXRlU2VsZWN0b3JQcm9wID0gKGxhYmVsVGV4dDogc3RyaW5nLCBzZWxlY3RvckNsYXNzTmFtZTogc3RyaW5nLCBzZWxlY3RvckRlZmF1bHRWYWx1ZT86IHN0cmluZywgc2VsZWN0b3JPcHRpb25zOiBTZWxlY3Rvck9wdGlvbltdID0gW10sIHNlbGVjdENiOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZCA9IG51bGwhKTogSFRNTEVsZW1lbnQgPT4ge1xuICAgIGNvbnN0IHNlbGVjdG9yUHJvcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VpLXByb3AnKTtcbiAgICBjb25zdCBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VpLWxhYmVsJyk7XG4gICAgbGFiZWwuc2V0QXR0cmlidXRlKCdzbG90JywgJ2xhYmVsJyk7XG4gICAgbGFiZWwuaW5uZXJUZXh0ID0gbGFiZWxUZXh0O1xuICAgIGNvbnN0IHNlbGVjdG9yID0gY3JlYXRlU2VsZWN0b3Ioc2VsZWN0b3JDbGFzc05hbWUsIHNlbGVjdG9yRGVmYXVsdFZhbHVlLCBzZWxlY3Rvck9wdGlvbnMsIHNlbGVjdENiKTtcbiAgICBzZWxlY3RvclByb3AuYXBwZW5kQ2hpbGQobGFiZWwpO1xuICAgIHNlbGVjdG9yUHJvcC5hcHBlbmRDaGlsZChzZWxlY3Rvcik7XG5cbiAgICByZXR1cm4gc2VsZWN0b3JQcm9wO1xufTtcblxuY29uc3QgY3JlYXRlU2VsZWN0b3IgPSAoY2xhc3NOYW1lOiBzdHJpbmcsIGRlZmF1bHRWYWx1ZT86IHN0cmluZywgc2VsZWN0b3JPcHRpb25zOiBTZWxlY3Rvck9wdGlvbltdID0gW10sIHNlbGVjdENiOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZCA9IG51bGwhKTogSFRNTEVsZW1lbnQgPT4ge1xuICAgIGNvbnN0IHNlbGVjdG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWktc2VsZWN0Jyk7XG4gICAgc2VsZWN0b3Iuc2V0QXR0cmlidXRlKCdjbGFzcycsIGNsYXNzTmFtZSk7XG4gICAgc2VsZWN0b3Iuc2V0QXR0cmlidXRlKCdzbG90JywgJ2NvbnRlbnQnKTtcbiAgICBpZiAoZGVmYXVsdFZhbHVlKSB7XG4gICAgICAgIHNlbGVjdG9yLnNldEF0dHJpYnV0ZSgndmFsdWUnLCBkZWZhdWx0VmFsdWUpO1xuICAgIH1cbiAgICBzZWxlY3Rvck9wdGlvbnMuZm9yRWFjaCgob3B0aW9uKSA9PiB7XG4gICAgICAgIHNlbGVjdG9yLmFwcGVuZENoaWxkKGNyZWF0ZU9wdGlvbihvcHRpb24pKTtcbiAgICB9KTtcbiAgICBzZWxlY3Rvci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgIHNlbGVjdENiICYmIHNlbGVjdENiKGV2ZW50LnRhcmdldD8udmFsdWUpO1xuICAgIH0pO1xuICAgIHNlbGVjdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbmZpcm0nLCAoZXZlbnQpID0+IHtcbiAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgIHNlbGVjdENiICYmIHNlbGVjdENiKGV2ZW50LnRhcmdldD8udmFsdWUpO1xuICAgIH0pO1xuICAgIHJldHVybiBzZWxlY3Rvcjtcbn07XG5cbmludGVyZmFjZSBTZWxlY3Rvck9wdGlvbiB7XG4gICAgdmFsdWU6IHN0cmluZztcbiAgICB0ZXh0OiBzdHJpbmc7XG59XG5cbmNvbnN0IGNyZWF0ZU9wdGlvbiA9IChzZWxlY3Rvck9wdGlvbjogU2VsZWN0b3JPcHRpb24pOiBIVE1MRWxlbWVudCA9PiB7XG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgb3B0aW9uLnNldEF0dHJpYnV0ZSgndmFsdWUnLCBzZWxlY3Rvck9wdGlvbi52YWx1ZSk7XG4gICAgb3B0aW9uLmlubmVyVGV4dCA9IHNlbGVjdG9yT3B0aW9uLnRleHQ7XG4gICAgcmV0dXJuIG9wdGlvbjtcbn07XG5cbnR5cGUgVUlQcm9wID0gSFRNTEVsZW1lbnQgJiB7IHJlbmRlcihkdW1wOiBhbnkpOiB2b2lkIH07XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlKHRoaXM6IFBhbmVsVGhpcywgZHVtcDogYW55KSB7XG4gICAgdGhpcy5kdW1wID0gZHVtcDtcbiAgICBjb25zdCBjb250ZW50ID0gKHRoaXMuJC5jb250ZW50IGFzIEhUTUxFbGVtZW50KTtcblxuICAgIGZvciAoY29uc3Qga2V5IGluIGR1bXAudmFsdWUpIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBkdW1wLnZhbHVlW2tleV07XG4gICAgICAgIGxldCAkcHJvcDogVUlQcm9wIHwgbnVsbCA9IGNvbnRlbnQucXVlcnlTZWxlY3RvcihgdWktcHJvcFtrZXk9JHtrZXl9XWApO1xuICAgICAgICBpZiAoJHByb3ApIHtcbiAgICAgICAgICAgICRwcm9wLmhpZGRlbiA9ICF2YWx1ZS52aXNpYmxlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdmFsdWUudmlzaWJsZSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoISRwcm9wKSB7XG4gICAgICAgICAgICAkcHJvcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VpLXByb3AnKSBhcyBVSVByb3A7XG4gICAgICAgICAgICAkcHJvcC5zZXRBdHRyaWJ1dGUoJ2tleScsIGtleSk7XG4gICAgICAgICAgICAkcHJvcC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnZHVtcCcpO1xuICAgICAgICAgICAgY29udGVudC5hcHBlbmRDaGlsZCgkcHJvcCk7XG4gICAgICAgIH1cbiAgICAgICAgJHByb3AucmVuZGVyKHZhbHVlKTtcblxuICAgICAgICBpZiAoa2V5ID09IFwiZGVmYXVsdENsaXBcIikge1xuICAgICAgICAgICAgY29uc3QgdXVpZCA9IHZhbHVlPy52YWx1ZT8udXVpZDtcbiAgICAgICAgICAgIGlmICh1dWlkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYXNzZXRJbmZvID0gYXdhaXQgRWRpdG9yLk1lc3NhZ2UucmVxdWVzdCgnYXNzZXQtZGInLCAncXVlcnktYXNzZXQtaW5mbycsIHV1aWQpIGFzIEFzc2V0SW5mbyB8IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKGFzc2V0SW5mbykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gcmVhZEZpbGVTeW5jKGFzc2V0SW5mby5maWxlLCAndXRmOCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqc29uICYmIEFycmF5LmlzQXJyYXkoanNvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjbGlwID0ganNvbi5maW5kKGl0ZW0gPT4gaXRlbS5fX3R5cGVfXyA9PSBcImNjLkFuaW1hdGlvbkNsaXBcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2xpcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjbGlwRXZlbnRzID0gY2xpcC5fZXZlbnRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2xpcEV2ZW50cyAmJiBBcnJheS5pc0FycmF5KGNsaXBFdmVudHMpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludGVyZmFjZSBJRXZlbnQge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyYW1lOiBudW1iZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuYzogc3RyaW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtczogc3RyaW5nW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXAgPSBuZXcgTWFwPG51bWJlciwgSUV2ZW50PigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBldmVudCBvZiBjbGlwRXZlbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaGFzID0gbWFwLmdldChldmVudC5mcmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmnInlkI3lrZfnmoTkuovku7bkvJrmm7/mjaLmjonmsqHmnInlkI3lrZfnmoTkuovku7ZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoYXMuZnVuYyAmJiBldmVudC5mdW5jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXAuc2V0KGV2ZW50LmZyYW1lLCBldmVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXAuc2V0KGV2ZW50LmZyYW1lLCBldmVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBldmVudHM6IElFdmVudFtdID0gQXJyYXkuZnJvbShtYXAudmFsdWVzKCkpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRwcm9wID0gY29udGVudC5xdWVyeVNlbGVjdG9yKGB1aS1wcm9wW2tleT1TdGF0ZV1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcHJvcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nU2VsZWN0b3IgPSAkcHJvcC5xdWVyeVNlbGVjdG9yKCd1aS1zZWxlY3QnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdTZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDorrDlvZXlvZPliY3pgInkuK3nmoTlgLxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFZhbHVlID0gZXhpc3RpbmdTZWxlY3Rvci5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5riF56m6546w5pyJb3B0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZXhpc3RpbmdTZWxlY3Rvci5maXJzdENoaWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZ1NlbGVjdG9yLnJlbW92ZUNoaWxkKGV4aXN0aW5nU2VsZWN0b3IuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmt7vliqDmlrDnmoRvcHRpb25zXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50cy5mb3JFYWNoKChldmVudCwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbiA9IGNyZWF0ZU9wdGlvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGluZGV4LnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogZXZlbnQuZnVuYyB8fCBcIueKtuaAgVwiICsgKGluZGV4ICsgMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdTZWxlY3Rvci5hcHBlbmRDaGlsZChvcHRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmgaLlpI3kuYvliY3pgInkuK3nmoTlgLxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdTZWxlY3Rvci5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgY3VycmVudFZhbHVlISk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgRWRpdG9yLk1lc3NhZ2UucmVxdWVzdCgnc2NlbmUnLCAnZXhlY3V0ZS1jb21wb25lbnQtbWV0aG9kJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXVpZDogZHVtcC52YWx1ZS51dWlkLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2VkaXRvckNoYW5nZVN0YXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IGN1cnJlbnRWYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHByb3AgPSBjcmVhdGVTZWxlY3RvclByb3AoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJTdGF0ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZXZlbnRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudHMubWFwKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZXZlbnQsIGluZGV4KSA9PiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHZhbHVlOiBpbmRleC50b1N0cmluZygpLCB0ZXh0OiBldmVudC5mdW5jIHx8IFwi54q25oCBXCIgKyAoaW5kZXggKyAxKSB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzeW5jICh2OiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgRWRpdG9yLk1lc3NhZ2UucmVxdWVzdCgnc2NlbmUnLCAnZXhlY3V0ZS1jb21wb25lbnQtbWV0aG9kJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXVpZDogZHVtcC52YWx1ZS51dWlkLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2VkaXRvckNoYW5nZVN0YXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IHYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgYXMgVUlQcm9wO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcHJvcC5zZXRBdHRyaWJ1dGUoXCJrZXlcIiwgXCJTdGF0ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuYXBwZW5kQ2hpbGQoJHByb3ApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGF0ZSA9IGF3YWl0IEVkaXRvci5NZXNzYWdlLnJlcXVlc3QoJ3NjZW5lJywgJ2V4ZWN1dGUtY29tcG9uZW50LW1ldGhvZCcsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dWlkOiBkdW1wLnZhbHVlLnV1aWQudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2VkaXRvckdldFN0YXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSAkcHJvcC5xdWVyeVNlbGVjdG9yKCd1aS1zZWxlY3QnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yLnNldEF0dHJpYnV0ZSgndmFsdWUnLCBzdGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgRWRpdG9yLk1lc3NhZ2UucmVxdWVzdCgnc2NlbmUnLCAnZXhlY3V0ZS1jb21wb25lbnQtbWV0aG9kJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dWlkOiBkdW1wLnZhbHVlLnV1aWQudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdlZGl0b3JDaGFuZ2VTdGF0ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IHN0YXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBwYXJzZSB2aWV3IHN0YXRlIGRhdGE6XCIsIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0iXX0=