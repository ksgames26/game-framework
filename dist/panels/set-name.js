'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
const path_1 = require("path");
const fs_1 = require("fs");
const vue_1 = require("vue");
const short_name_1 = require("../short-name");
// 根据分类拆分shortNames
function categorizeShortNames(shortNames) {
    const categories = {
        uiComponents: {},
        mediaComponents: {},
        renderComponents: {},
        animationComponents: {},
        otherComponents: {}
    };
    // UI组件 (index 0-13)
    const keys = Object.keys(shortNames);
    keys.slice(0, 14).forEach(key => {
        categories.uiComponents[key] = shortNames[key];
    });
    // 多媒体组件 (index 14-17)
    keys.slice(14, 18).forEach(key => {
        categories.mediaComponents[key] = shortNames[key];
    });
    // 渲染相关 (index 18-22)
    keys.slice(18, 23).forEach(key => {
        categories.renderComponents[key] = shortNames[key];
    });
    // 动画相关 (index 23-26)
    keys.slice(23, 27).forEach(key => {
        categories.animationComponents[key] = shortNames[key];
    });
    // 其他 (index 27+)
    keys.slice(27).forEach(key => {
        categories.otherComponents[key] = shortNames[key];
    });
    return categories;
}
let uuidSelected = "";
const options = {
    listeners: {},
    style: (0, fs_1.readFileSync)((0, path_1.join)(__dirname, '../../static/style/set-name/style.css'), 'utf-8'),
    template: (0, fs_1.readFileSync)((0, path_1.join)(__dirname, '../../static/template/set-name/index.html'), 'utf-8'),
    $: {
        app: "#app" // 指定一个ID选择器，确保HTML模板中有对应的元素
    },
    methods: {},
    async ready() {
        const uuid = arguments[0];
        if (!uuid) {
            await Editor.Panel.close('game-framework.set-name');
            Editor.Dialog.error('请选择一个节点');
            return;
        }
        uuidSelected = uuid;
        // 获取组件分类
        const categories = categorizeShortNames(short_name_1.shortNames);
        // 创建Vue应用
        const app = (0, vue_1.createApp)({
            // 使用内联模板
            data() {
                return {
                    selectedType: '',
                    customName: '',
                    uiComponents: categories.uiComponents,
                    mediaComponents: categories.mediaComponents,
                    renderComponents: categories.renderComponents,
                    animationComponents: categories.animationComponents,
                    otherComponents: categories.otherComponents,
                    allComponents: short_name_1.shortNames
                };
            },
            methods: {
                updateType(event) {
                    this.selectedType = event.target.value;
                },
                updateName(event) {
                    this.customName = event.target.value;
                },
                confirm() {
                    if (this.selectedType) {
                        // 组合名称
                        const fullName = `_${this.selectedType}${this.customName}`;
                        // 发送事件
                        Editor.Message.request("scene", "set-property", {
                            uuid: uuidSelected,
                            path: "name",
                            dump: {
                                type: "string",
                                value: fullName
                            }
                        });
                        // 关闭面板
                        Editor.Panel.close('game-framework.set-name');
                    }
                    else {
                        Editor.Dialog.warn('请选择一个组件类型');
                    }
                },
                cancel() {
                    Editor.Panel.close('game-framework.set-name');
                }
            },
            created() {
                // 默认选中第一个UI组件
                if (Object.keys(this.uiComponents).length > 0) {
                    this.selectedType = Object.keys(this.uiComponents)[0];
                }
            }
        });
        app.config.compilerOptions.isCustomElement = (tag) => tag.startsWith('ui-');
        // 挂载Vue应用到DOM
        app.mount(this.$.app);
    },
    async beforeClose() {
        // 面板关闭前的处理
    },
    close() {
        // 面板关闭后的处理
    },
};
module.exports = Editor.Panel.define(options);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2V0LW5hbWUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zb3VyY2UvcGFuZWxzL3NldC1uYW1lLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFlBQVksQ0FBQzs7QUFDYiwrQkFBNEI7QUFDNUIsMkJBQWtDO0FBQ2xDLDZCQUFnQztBQUNoQyw4Q0FBMkM7QUFnQjNDLG1CQUFtQjtBQUNuQixTQUFTLG9CQUFvQixDQUFDLFVBQXdCO0lBQ2xELE1BQU0sVUFBVSxHQUF1QjtRQUNuQyxZQUFZLEVBQUUsRUFBRTtRQUNoQixlQUFlLEVBQUUsRUFBRTtRQUNuQixnQkFBZ0IsRUFBRSxFQUFFO1FBQ3BCLG1CQUFtQixFQUFFLEVBQUU7UUFDdkIsZUFBZSxFQUFFLEVBQUU7S0FDdEIsQ0FBQztJQUVGLG9CQUFvQjtJQUNwQixNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQ3JDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRTtRQUM1QixVQUFVLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNuRCxDQUFDLENBQUMsQ0FBQztJQUVILHNCQUFzQjtJQUN0QixJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUU7UUFDN0IsVUFBVSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsR0FBRyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDdEQsQ0FBQyxDQUFDLENBQUM7SUFFSCxxQkFBcUI7SUFDckIsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1FBQzdCLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLENB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bmltcG9ydCB7IGpvaW4gfSBmcm9tICdwYXRoJztcbmltcG9ydCB7IHJlYWRGaWxlU3luYyB9IGZyb20gJ2ZzJztcbmltcG9ydCB7IGNyZWF0ZUFwcCB9IGZyb20gJ3Z1ZSc7XG5pbXBvcnQgeyBzaG9ydE5hbWVzIH0gZnJvbSAnLi4vc2hvcnQtbmFtZSc7XG5cbi8vIOWumuS5iee7hOS7tuexu+Wei+aOpeWPo1xuaW50ZXJmYWNlIFNob3J0TmFtZU1hcCB7XG4gICAgW2tleTogc3RyaW5nXTogc3RyaW5nO1xufVxuXG4vLyDliIbnsbvlkI7nmoTnu4Tku7bmjqXlj6NcbmludGVyZmFjZSBDYXRlZ29yeUNvbXBvbmVudHMge1xuICAgIHVpQ29tcG9uZW50czogU2hvcnROYW1lTWFwO1xuICAgIG1lZGlhQ29tcG9uZW50czogU2hvcnROYW1lTWFwO1xuICAgIHJlbmRlckNvbXBvbmVudHM6IFNob3J0TmFtZU1hcDtcbiAgICBhbmltYXRpb25Db21wb25lbnRzOiBTaG9ydE5hbWVNYXA7XG4gICAgb3RoZXJDb21wb25lbnRzOiBTaG9ydE5hbWVNYXA7XG59XG5cbi8vIOagueaNruWIhuexu+aLhuWIhnNob3J0TmFtZXNcbmZ1bmN0aW9uIGNhdGVnb3JpemVTaG9ydE5hbWVzKHNob3J0TmFtZXM6IFNob3J0TmFtZU1hcCk6IENhdGVnb3J5Q29tcG9uZW50cyB7XG4gICAgY29uc3QgY2F0ZWdvcmllczogQ2F0ZWdvcnlDb21wb25lbnRzID0ge1xuICAgICAgICB1aUNvbXBvbmVudHM6IHt9LFxuICAgICAgICBtZWRpYUNvbXBvbmVudHM6IHt9LFxuICAgICAgICByZW5kZXJDb21wb25lbnRzOiB7fSxcbiAgICAgICAgYW5pbWF0aW9uQ29tcG9uZW50czoge30sXG4gICAgICAgIG90aGVyQ29tcG9uZW50czoge31cbiAgICB9O1xuXG4gICAgLy8gVUnnu4Tku7YgKGluZGV4IDAtMTMpXG4gICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHNob3J0TmFtZXMpO1xuICAgIGtleXMuc2xpY2UoMCwgMTQpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgY2F0ZWdvcmllcy51aUNvbXBvbmVudHNba2V5XSA9IHNob3J0TmFtZXNba2V5XTtcbiAgICB9KTtcblxuICAgIC8vIOWkmuWqkuS9k+e7hOS7tiAoaW5kZXggMTQtMTcpXG4gICAga2V5cy5zbGljZSgxNCwgMTgpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgY2F0ZWdvcmllcy5tZWRpYUNvbXBvbmVudHNba2V5XSA9IHNob3J0TmFtZXNba2V5XTtcbiAgICB9KTtcblxuICAgIC8vIOa4suafk+ebuOWFsyAoaW5kZXggMTgtMjIpXG4gICAga2V5cy5zbGljZSgxOCwgMjMpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgY2F0ZWdvcmllcy5yZW5kZXJDb21wb25lbnRzW2tleV0gPSBzaG9ydE5hbWVzW2tleV07XG4gICAgfSk7XG5cbiAgICAvLyDliqjnlLvnm7jlhbMgKGluZGV4IDIzLTI2KVxuICAgIGtleXMuc2xpY2UoMjMsIDI3KS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIGNhdGVnb3JpZXMuYW5pbWF0aW9uQ29tcG9uZW50c1trZXldID0gc2hvcnROYW1lc1trZXldO1xuICAgIH0pO1xuXG4gICAgLy8g5YW25LuWIChpbmRleCAyNyspXG4gICAga2V5cy5zbGljZSgyNykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBjYXRlZ29yaWVzLm90aGVyQ29tcG9uZW50c1trZXldID0gc2hvcnROYW1lc1trZXldO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGNhdGVnb3JpZXM7XG59XG5cbmxldCB1dWlkU2VsZWN0ZWQgPSBcIlwiO1xuY29uc3Qgb3B0aW9ucyA9IHtcbiAgICBsaXN0ZW5lcnM6IHt9LFxuICAgIHN0eWxlOiByZWFkRmlsZVN5bmMoam9pbihfX2Rpcm5hbWUsICcuLi8uLi9zdGF0aWMvc3R5bGUvc2V0LW5hbWUvc3R5bGUuY3NzJyksICd1dGYtOCcpLFxuICAgIHRlbXBsYXRlOiByZWFkRmlsZVN5bmMoam9pbihfX2Rpcm5hbWUsICcuLi8uLi9zdGF0aWMvdGVtcGxhdGUvc2V0LW5hbWUvaW5kZXguaHRtbCcpLCAndXRmLTgnKSxcbiAgICAkOiB7XG4gICAgICAgYXBwOiBcIiNhcHBcIiAvLyDmjIflrprkuIDkuKpJROmAieaLqeWZqO+8jOehruS/nUhUTUzmqKHmnb/kuK3mnInlr7nlupTnmoTlhYPntKBcbiAgICB9LFxuICAgIG1ldGhvZHM6IHtcbiAgICAgICAgXG4gICAgfSxcbiAgICBhc3luYyByZWFkeSgpIHtcblxuICAgICAgICBjb25zdCB1dWlkID0gYXJndW1lbnRzWzBdO1xuICAgICAgICBpZiAoIXV1aWQpIHtcbiAgICAgICAgICAgIGF3YWl0IEVkaXRvci5QYW5lbC5jbG9zZSgnZ2FtZS1mcmFtZXdvcmsuc2V0LW5hbWUnKTtcbiAgICAgICAgICAgIEVkaXRvci5EaWFsb2cuZXJyb3IoJ+ivt+mAieaLqeS4gOS4quiKgueCuScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdXVpZFNlbGVjdGVkID0gdXVpZDtcblxuICAgICAgICAvLyDojrflj5bnu4Tku7bliIbnsbtcbiAgICAgICAgY29uc3QgY2F0ZWdvcmllcyA9IGNhdGVnb3JpemVTaG9ydE5hbWVzKHNob3J0TmFtZXMpO1xuICAgICAgICBcbiAgICAgICAgLy8g5Yib5bu6VnVl5bqU55SoXG4gICAgICAgIGNvbnN0IGFwcCA9IGNyZWF0ZUFwcCh7XG4gICAgICAgICAgICAvLyDkvb/nlKjlhoXogZTmqKHmnb9cbiAgICAgICAgICAgIGRhdGEoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRUeXBlOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tTmFtZTogJycsXG4gICAgICAgICAgICAgICAgICAgIHVpQ29tcG9uZW50czogY2F0ZWdvcmllcy51aUNvbXBvbmVudHMsXG4gICAgICAgICAgICAgICAgICAgIG1lZGlhQ29tcG9uZW50czogY2F0ZWdvcmllcy5tZWRpYUNvbXBvbmVudHMsXG4gICAgICAgICAgICAgICAgICAgIHJlbmRlckNvbXBvbmVudHM6IGNhdGVnb3JpZXMucmVuZGVyQ29tcG9uZW50cyxcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uQ29tcG9uZW50czogY2F0ZWdvcmllcy5hbmltYXRpb25Db21wb25lbnRzLFxuICAgICAgICAgICAgICAgICAgICBvdGhlckNvbXBvbmVudHM6IGNhdGVnb3JpZXMub3RoZXJDb21wb25lbnRzLFxuICAgICAgICAgICAgICAgICAgICBhbGxDb21wb25lbnRzOiBzaG9ydE5hbWVzXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZXRob2RzOiB7XG4gICAgICAgICAgICAgICAgdXBkYXRlVHlwZShldmVudDogeyB0YXJnZXQ6IHsgdmFsdWU6IHN0cmluZyB9IH0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFR5cGUgPSBldmVudC50YXJnZXQudmFsdWU7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB1cGRhdGVOYW1lKGV2ZW50OiB7IHRhcmdldDogeyB2YWx1ZTogc3RyaW5nIH0gfSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1c3RvbU5hbWUgPSBldmVudC50YXJnZXQudmFsdWU7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb25maXJtKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOe7hOWQiOWQjeensFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZnVsbE5hbWUgPSBgXyR7dGhpcy5zZWxlY3RlZFR5cGV9JHt0aGlzLmN1c3RvbU5hbWV9YDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWPkemAgeS6i+S7tlxuICAgICAgICAgICAgICAgICAgICAgICAgRWRpdG9yLk1lc3NhZ2UucmVxdWVzdChcInNjZW5lXCIsIFwic2V0LXByb3BlcnR5XCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dWlkOiB1dWlkU2VsZWN0ZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogXCJuYW1lXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVtcDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZnVsbE5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWFs+mXremdouadv1xuICAgICAgICAgICAgICAgICAgICAgICAgRWRpdG9yLlBhbmVsLmNsb3NlKCdnYW1lLWZyYW1ld29yay5zZXQtbmFtZScpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgRWRpdG9yLkRpYWxvZy53YXJuKCfor7fpgInmi6nkuIDkuKrnu4Tku7bnsbvlnosnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY2FuY2VsKCkge1xuICAgICAgICAgICAgICAgICAgICBFZGl0b3IuUGFuZWwuY2xvc2UoJ2dhbWUtZnJhbWV3b3JrLnNldC1uYW1lJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNyZWF0ZWQoKSB7XG4gICAgICAgICAgICAgICAgLy8g6buY6K6k6YCJ5Lit56ys5LiA5LiqVUnnu4Tku7ZcbiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy51aUNvbXBvbmVudHMpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFR5cGUgPSBPYmplY3Qua2V5cyh0aGlzLnVpQ29tcG9uZW50cylbMF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIGFwcC5jb25maWcuY29tcGlsZXJPcHRpb25zLmlzQ3VzdG9tRWxlbWVudCA9ICh0YWcpID0+IHRhZy5zdGFydHNXaXRoKCd1aS0nKTtcbiAgICAgICAgXG4gICAgICAgIC8vIOaMgui9vVZ1ZeW6lOeUqOWIsERPTVxuICAgICAgICBhcHAubW91bnQodGhpcy4kLmFwcCk7XG4gICAgfSxcbiAgICBhc3luYyBiZWZvcmVDbG9zZSgpIHtcbiAgICAgICAgLy8g6Z2i5p2/5YWz6Zet5YmN55qE5aSE55CGXG4gICAgfSxcbiAgICBjbG9zZSgpIHtcbiAgICAgICAgLy8g6Z2i5p2/5YWz6Zet5ZCO55qE5aSE55CGXG4gICAgfSxcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gRWRpdG9yLlBhbmVsLmRlZmluZShvcHRpb25zKTtcbiJdfQ==